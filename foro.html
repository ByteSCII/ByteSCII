<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Byte - Página de Reseñas</title>
    <link rel="icon" type="image/x-icon" href="./images/logo.ico">
    <meta name="description" content="Página de reseñas de Byte. Comparte y lee opiniones sobre nuestros servicios.">
    <meta name="keywords" content="Byte, reseñas, opiniones, feedback, servicios, diseño web, marketing digital">
    <meta property="og:title" content="Byte - Página de Reseñas">
    <meta property="og:description" content="Página de reseñas de Byte. Comparte y lee opiniones sobre nuestros servicios.">
    <meta property="og:type" content="website">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables for Firebase access
        window.firebaseApp = null;
        window.db = null;
        window.auth = null;
        window.currentUserId = null;

        // Firebase configuration provided by the user
        const appId = "1:827941655623:web:887b7a5220fd416eeccd62";
        const firebaseConfig = {
            apiKey: "AIzaSyCYpAKjzz-rUBlZYkaEPiZMawfAM8-nQ3Y",
            authDomain: "byteweb-13a12.firebaseapp.com",
            projectId: "byteweb-13a12",
            storageBucket: "byteweb-13a12.firebasestorage.app",
            messagingSenderId: "827941655623",
            appId: "1:827941655623:web:887b7a5220fd416eeccd62"
        };
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;


        // Initialize Firebase
        window.firebaseApp = initializeApp(firebaseConfig);
        window.db = getFirestore(window.firebaseApp);
        window.auth = getAuth(window.firebaseApp);

        // Firebase authentication
        onAuthStateChanged(window.auth, async (user) => {
            if (user) {
                window.currentUserId = user.uid;
                console.log("Firebase Authenticated! User ID:", window.currentUserId);
                // Removed the line that displayed the user ID on the page.
                // document.getElementById('user-id-display').textContent = `ID de Usuario: ${window.currentUserId}`;
                // Now that we are authenticated, we can start listening for reviews
                initializeReviewsListener();
            } else { // User is not signed in
                if (initialAuthToken) {
                    try {
                        await signInWithCustomToken(window.auth, initialAuthToken);
                        console.log("Signed in with custom token.");
                    } catch (customTokenError) {
                        console.warn("Custom token sign-in failed, attempting anonymous sign-in:", customTokenError);
                        // If custom token fails, try anonymous sign-in
                        try {
                            await signInAnonymously(window.auth);
                            console.log("Signed in anonymously after custom token failure.");
                        } catch (anonymousError) {
                            console.error("Error during anonymous Firebase authentication:", anonymousError);
                            displayMessage('Error al autenticar: ' + anonymousError.message, 'bg-red-500');
                        }
                    }
                } else {
                    // No custom token, proceed directly to anonymous sign-in
                    try {
                        await signInAnonymously(window.auth);
                        console.log("Signed in anonymously.");
                    } catch (anonymousError) {
                        console.error("Error during anonymous Firebase authentication:", anonymousError);
                        displayMessage('Error al autenticar: ' + anonymousError.message, 'bg-red-500');
                    }
                }
            }
        });

        // Function to initialize Firestore listener for reviews
        function initializeReviewsListener() {
            if (!window.db) {
                console.error("Firestore is not initialized.");
                return;
            }

            // Collection reference for public reviews
            const reviewsCollectionRef = collection(window.db, `/artifacts/${appId}/public/data/reviews`);
            
            // Query to order by a timestamp (e.g., creation date) - requires index
            // For simplicity, we'll fetch all and sort in memory if orderBy causes issues
            const q = query(reviewsCollectionRef); // Removed orderBy to avoid index issues

            onSnapshot(q, (snapshot) => {
                const reviewsContainer = document.getElementById('reviews-container');
                const noReviewsMessage = document.getElementById('no-reviews-message');
                reviewsContainer.innerHTML = ''; // Clear current reviews

                if (snapshot.empty) {
                    noReviewsMessage.classList.remove('hidden');
                } else {
                    noReviewsMessage.classList.add('hidden');
                    const fetchedReviews = [];
                    snapshot.forEach(doc => {
                        const reviewData = doc.data();
                        fetchedReviews.push({ id: doc.id, ...reviewData });
                    });

                    // Sort reviews by timestamp if available, otherwise by a default
                    fetchedReviews.sort((a, b) => (b.timestamp?.toDate() || 0) - (a.timestamp?.toDate() || 0));

                    fetchedReviews.forEach(review => {
                        reviewsContainer.appendChild(createReviewCard(review));
                    });
                }
            }, (error) => {
                console.error("Error fetching reviews:", error);
                displayMessage('Error al cargar reseñas: ' + error.message, 'bg-red-500');
            });
        }

        // Expose functions to global scope for other scripts
        window.addReviewToFirestore = async (reviewData) => {
            if (!window.db || !window.currentUserId) {
                displayMessage('No se pudo publicar la reseña. Autenticación pendiente.', 'bg-red-500');
                return;
            }
            try {
                const reviewsCollectionRef = collection(window.db, `/artifacts/${appId}/public/data/reviews`);
                await addDoc(reviewsCollectionRef, {
                    ...reviewData,
                    timestamp: serverTimestamp(), // Add server timestamp
                    userId: window.currentUserId // Store the user ID who submitted the review
                });
                displayMessage('¡Reseña publicada con éxito!', 'bg-green-500');
            } catch (error) {
                console.error("Error adding document:", error);
                displayMessage('Error al publicar reseña: ' + error.message, 'bg-red-500');
            }
        };

        // Helper function for creating review cards (defined here for modularity with Firebase)
        function createReviewCard(review) {
            const card = document.createElement('div');
            card.classList.add('review-card');

            const avatarLetter = review.name ? review.name.charAt(0).toUpperCase() : '?';

            card.innerHTML = `
                <div class="review-header">
                    <div class="reviewer-avatar">${avatarLetter}</div>
                    <div class="reviewer-info">
                        <h3>${review.name || 'Anónimo'}</h3>
                        <div class="star-rating">
                            ${generateStars(review.rating || 0)}
                        </div>
                    </div>
                </div>
                <div class="review-text-container">
                    <p>${review.text || 'Sin reseña.'}</p>
                </div>
            `;

            const reviewTextContainer = card.querySelector('.review-text-container');
            card.addEventListener('click', () => {
                reviewTextContainer.classList.toggle('expanded');
            });

            return card;
        }

        // Helper function to generate star icons
        function generateStars(rating) {
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                starsHtml += `<i class="fas fa-star star-icon ${i <= rating ? 'filled' : 'unfilled'}"></i>`;
            }
            return starsHtml;
        }

        // Helper function to display messages (reused from previous code)
        function displayMessage(text, bgColor) {
            const message = document.createElement('div');
            message.classList.add('fixed', 'bottom-4', 'left-1/2', '-translate-x-1/2', bgColor, 'text-white', 'p-3', 'rounded-lg', 'shadow-lg', 'z-[10001]', 'transition-opacity', 'duration-300', 'opacity-0');
            message.textContent = text;
            document.body.appendChild(message);

            setTimeout(() => {
                message.classList.add('opacity-100');
            }, 10); // Small delay to allow CSS transition

            setTimeout(() => {
                message.classList.remove('opacity-100');
                setTimeout(() => {
                    message.remove();
                }, 300); // Remove after fade out
            }, 3000); // Show for 3 seconds
        }

        // Ensure these helper functions are accessible globally
        window.createReviewCard = createReviewCard;
        window.generateStars = generateStars;
        window.displayMessage = displayMessage;

    </script>

    <style>
        /* Custom Tailwind CSS Configuration - Must be loaded before other styles */
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                        navigation: ['Montserrat', 'sans-serif'],
                    },
                    colors: {
                        'byte-dark-bg': '#0A0A1A',
                        'byte-accent-cyan': '#00FFFF',
                        'byte-light-bg': '#F8FAFC', /* Muy claro, casi blanco */
                        'byte-text-dark': '#374151', /* Gris oscuro */
                        'byte-text-light': '#F9FAFB', /* Gris muy claro, casi blanco */
                        'byte-secondary-dark': '#1A202C',
                        'whatsapp-green': '#25D366',
                        'whatsapp-dark-green': '#128C7E',
                        'review-text-color': '#1F2937', /* Nuevo color para el texto de la reseña, más oscuro */
                        'star-filled-color': '#FACC15', /* Amarillo para estrellas llenas (yellow-400 de Tailwind) */
                        'star-unfilled-color': '#D1D5DB', /* Gris claro para estrellas no llenas (gray-300 de Tailwind) */
                    }
                }
            }
        };

        /* Box-Sizing universal para un modelo de caja consistente */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        /* Estilos base para HTML y Body */
        html {
            height: 100%;
            width: 100%;
        }
        body {
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
            /* Eliminado background-color directo, ahora se usa el video */
            font-family: 'Inter', sans-serif; /* Aplicando Inter como fuente principal */
            color: #F9FAFB;
            margin: 0;
            padding: 0;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            /* Añadir padding superior para que el contenido no quede debajo del encabezado fijo */
            padding-top: 80px; /* Ajusta según la altura de tu encabezado */
            position: relative; /* Necesario para que el video de fondo se posicione correctamente */
            z-index: 1; /* Asegura que el contenido esté por encima del video */
        }

        /* Fondo de video */
        #video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Asegura que el video cubra todo el espacio */
            z-index: -1; /* Envía el video al fondo */
            background-color: #0A0A1A; /* Color de fallback si el video no carga */
        }

        /* Estilos para encabezados (h1-h6) */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif; /* Aplicando Montserrat para encabezados */
            color: #00FFFF;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
        }

        /* Estilo de contorno de texto */
        .text-stroke-cyan {
            -webkit-text-stroke: 1.5px #00FFFF;
            text-stroke: 1.5px #00FFFF;
            color: #FFFFFF;
            text-shadow: none;
        }

        /* Estilo de enlace deshabilitado */
        .disabled-link {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Estilos para deshabilitar la selección de texto y eventos de puntero en imágenes */
        img {
            pointer-events: none;
        }
        p, h1, h2, h3, h4, h5, h6, span, div:not(.map-container):not(.payment-card) {
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        /* Estilos para el encabezado fijo */
        .main-header {
            background-color: #0A0A1A; /* Fondo oscuro */
            color: #F9FAFB; /* Texto claro */
            padding: 0.5rem 0; /* Relleno */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra ligera */
            position: fixed; /* Fijo en la parte superior */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 50; /* Asegura que esté por encima del contenido */
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out; /* Transición suave */
        }

        .main-header.header-hide {
            transform: translateY(-100%); /* Desliza hacia arriba para ocultar */
            opacity: 0; /* Desvanece */
        }

        /* Estilos para los iconos SVG en el footer */
        .footer-social-icon {
            width: 1.75rem; /* Tamaño de los iconos sociales */
            height: 1.75rem;
            transition: transform 0.3s ease, fill 0.3s ease;
        }

        .footer-social-icon:hover {
            fill: #00FFFF; /* Cian al pasar el ratón */
            transform: translateY(-3px) scale(1.1);
        }

        /* Estilos específicos para las tarjetas de reseña - Ajustados para coincidir con el estilo de Byte */
        .review-card {
            background-color: #1A202C; /* byte-secondary-dark */
            border-radius: 0.75rem; /* Bordes redondeados */
            padding: 1.25rem; /* Relleno */
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.15); /* Sombra con acento cian */
            border: 1px solid rgba(0, 255, 255, 0.25); /* Borde cian sutil */
            display: flex;
            flex-direction: column;
            gap: 0.75rem; /* Espacio entre elementos dentro de la tarjeta */
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            text-align: left; /* Asegurar que el texto esté alineado a la izquierda */
        }

        .review-card:hover {
            transform: translateY(-5px); /* Efecto de levante más pronunciado */
            box-shadow: 0 8px 20px rgba(0, 255, 255, 0.3); /* Sombra más pronunciada al pasar el cursor */
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.25rem; /* Menos margen debajo del encabezado */
        }

        .reviewer-avatar {
            width: 3rem;
            height: 3rem;
            background-color: #00FFFF; /* byte-accent-cyan */
            color: #0A0A1A; /* byte-dark-bg para la letra del avatar */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.25rem;
            text-shadow: none;
            flex-shrink: 0;
            border: none; /* Eliminar borde del avatar */
        }

        .reviewer-info h3 {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: #F9FAFB; /* byte-text-light */
            text-shadow: none;
        }

        .star-rating {
            margin-top: 0.25rem; /* Pequeño margen superior para las estrellas */
        }

        .star-rating .star-icon {
            font-size: 0.9rem; /* Tamaño de estrella ligeramente más pequeño */
            margin-right: 0.125rem;
            transition: color 0.2s ease; /* Transición para el color de las estrellas */
        }

        .star-rating .star-icon.filled {
            color: var(--star-filled-color); /* Usar variable CSS para el color de la estrella llena */
        }

        .star-rating .star-icon.unfilled {
            color: var(--star-unfilled-color); /* Usar variable CSS para el color de la estrella no llena */
        }

        /* Estilo para el botón "Escribe tu reseña" */
        .write-review-button {
            display: inline-block;
            background-color: #00FFFF; /* Cian */
            color: #0A0A1A; /* Texto oscuro de Byte */
            font-weight: bold;
            padding: 0.5rem 1rem;
            border-radius: 9999px; /* Full rounded */
            box-shadow: 0 4px 6px rgba(0, 255, 255, 0.2);
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            text-decoration: none; /* Eliminar subrayado */
            font-size: 0.875rem; /* text-sm */
            margin-left: 1rem; /* Espacio entre los botones */
        }

        .write-review-button:hover {
            background-color: #00E5E5; /* Cian un poco más oscuro */
            transform: scale(1.05);
            box-shadow: 0 6px 10px rgba(0, 255, 255, 0.3);
        }

        /* Estilos del modal - AHORA CON EL ESTILO DE BYTE */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8); /* Fondo oscuro más opaco */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: #1A202C; /* byte-secondary-dark */
            padding: 2.5rem; /* Aumentar padding */
            border-radius: 1rem; /* Más redondeado */
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3); /* Sombra con acento cian */
            border: 1px solid rgba(0, 255, 255, 0.4); /* Borde cian sutil */
            width: 90%;
            max-width: 500px;
            transform: translateY(-30px); /* Más desplazamiento inicial */
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            color: #F9FAFB; /* Texto claro por defecto en el modal */
        }

        .modal-overlay.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-header {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem; /* Más grande */
            font-weight: 700;
            color: #00FFFF; /* byte-accent-cyan */
            margin-bottom: 2rem; /* Más espacio */
            text-align: center;
            text-shadow: 0 0 8px rgba(0, 255, 255, 0.6); /* Sombra de texto cian */
        }

        .modal-form label {
            display: block;
            font-size: 1.05rem; /* Ligeramente más grande */
            font-weight: 600;
            color: #F9FAFB; /* byte-text-light */
            margin-bottom: 0.75rem; /* Más espacio */
        }

        .modal-form input[type="text"],
        .modal-form textarea {
            width: 100%;
            padding: 1rem; /* Más padding */
            border: 1px solid #00FFFF; /* Borde cian */
            border-radius: 0.75rem; /* Más redondeado */
            margin-bottom: 1.5rem; /* Más espacio */
            font-size: 1.05rem;
            color: #F9FAFB; /* byte-text-light */
            background-color: #0A0A1A; /* byte-dark-bg para inputs */
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .modal-form input::placeholder,
        .modal-form textarea::placeholder {
            color: rgba(249, 250, 251, 0.6); /* Placeholder más claro */
        }


        .modal-form input[type="text"]:focus,
        .modal-form textarea:focus {
            border-color: #00FFFF; /* Cian al enfocar */
            box-shadow: 0 0 0 3px rgba(0, 255, 255, 0.4); /* Sombra más grande */
        }

        .modal-form textarea {
            min-height: 120px; /* Un poco más alto */
            resize: vertical;
        }

        .modal-star-rating {
            display: flex;
            justify-content: center;
            gap: 0.5rem; /* Más espacio entre estrellas */
            margin-bottom: 2rem; /* Más espacio */
        }

        .modal-star-rating .star-icon {
            font-size: 2.2rem; /* Estrellas más grandes */
            cursor: pointer;
            transition: color 0.2s ease, transform 0.1s ease;
        }

        .modal-star-rating .star-icon:hover {
            transform: scale(1.1); /* Efecto de crecimiento al pasar el ratón */
        }

        .modal-star-rating .star-icon.selected {
            color: var(--star-filled-color); /* Amarillo */
        }

        .modal-star-rating .star-icon.unselected {
            color: var(--star-unfilled-color); /* Gris */
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1.5rem; /* Más espacio entre botones */
            margin-top: 1.5rem; /* Reducido para dejar espacio al texto de aceptación */
        }

        .modal-buttons button {
            padding: 0.8rem 2rem; /* Más padding */
            border-radius: 9999px; /* Full rounded */
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .modal-buttons .cancel-button {
            background-color: #EF4444; /* Rojo */
            color: #FFFFFF;
            border: none;
        }

        .modal-buttons .cancel-button:hover {
            background-color: #DC2626; /* Rojo más oscuro */
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
        }

        .modal-buttons .submit-button {
            background-color: #00FFFF; /* Cian */
            color: #0A0A1A; /* Texto oscuro de Byte */
            border: none;
        }

        .modal-buttons .submit-button:hover {
            background-color: #00E5E5; /* Cian más oscuro */
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.4);
        }

        /* Estilos del modal de reglas */
        .rules-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9); /* Fondo muy oscuro y opaco para bloquear el contenido */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20000; /* Asegura que esté por encima de todos los demás elementos, incluido el modal de reseñas */
            opacity: 1; /* Visible por defecto */
            visibility: visible;
            transition: opacity 0.4s ease-in-out, visibility 0.4s ease-in-out;
        }

        .rules-modal-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .rules-modal-content {
            background-color: #0A0A1A; /* byte-dark-bg */
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.5); /* Sombra intensa cian */
            border: 2px solid #00FFFF; /* Borde cian más pronunciado */
            width: 95%;
            max-width: 600px;
            transform: translateY(0); /* Sin animación de entrada para que aparezca inmediatamente */
            opacity: 1;
            color: #F9FAFB;
            text-align: center;
        }

        .rules-modal-content h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: #00FFFF;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
        }

        .rules-modal-content p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            color: #CBD5E0; /* Gris claro para el texto de las reglas */
        }

        .rules-modal-content ul {
            list-style: none; /* Eliminar viñetas */
            padding: 0;
            margin-bottom: 2rem;
            text-align: left;
            max-height: 200px; /* Limitar altura para reglas largas */
            overflow-y: auto; /* Scroll si el contenido es muy largo */
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 0.5rem;
            padding: 1rem;
            background-color: rgba(0, 255, 255, 0.05); /* Fondo muy sutil para la lista */
        }

        /* Estilos de la barra de desplazamiento para WebKit (Chrome, Safari, Edge) */
        .rules-modal-content ul::-webkit-scrollbar {
            width: 12px; /* Ancho de la barra de desplazamiento */
        }

        .rules-modal-content ul::-webkit-scrollbar-track {
            background: #1A202C; /* Color de fondo de la pista de la barra de desplazamiento */
            border-radius: 10px;
        }

        .rules-modal-content ul::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3); /* Colores del arcoíris */
            border-radius: 10px;
            animation: rainbowScrollbar 8s linear infinite; /* Animación de arcoíris */
        }

        /* Animación para el efecto de arcoíris en la barra de desplazamiento */
        @keyframes rainbowScrollbar {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        /* Estilos para Firefox (menos control sobre el gradiente animado) */
        .rules-modal-content ul {
            scrollbar-width: thin; /* "auto" o "none" */
            scrollbar-color: #00FFFF #1A202C; /* color del pulgar y color de la pista */
        }

        .rules-modal-content ul li {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: #F9FAFB;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .rules-modal-content ul li:last-child {
            margin-bottom: 0;
        }

        .rules-modal-content ul li::before {
            content: '•'; /* Punto de lista personalizado */
            color: #00FFFF; /* Cian para las viñetas */
            font-weight: bold;
            font-size: 1.2em;
            margin-top: -2px; /* Ajuste fino */
        }

        .rules-modal-content .accept-button {
            background-color: #00FFFF; /* Cian */
            color: #0A0A1A; /* Texto oscuro de Byte */
            font-weight: bold;
            padding: 0.8rem 2.5rem;
            border-radius: 9999px;
            box-shadow: 0 4px 15px rgba(0, 255, 255, 0.5);
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .rules-modal-content .accept-button:hover {
            background-color: #00E5E5;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 255, 255, 0.6);
        }
        
        body.modal-open {
            overflow: hidden; /* Evitar el scroll del fondo cuando un modal está abierto */
        }

        /* Estilo para el texto de aceptación en el modal de reseña */
        .review-acceptance-text {
            font-size: 0.875rem; /* text-sm */
            color: #CBD5E0; /* Gris claro */
            text-align: center;
            margin-top: 1rem; /* Espacio superior */
            margin-bottom: 1rem; /* Espacio inferior */
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .main-header .flex.justify-between {
                flex-direction: column;
                align-items: center;
                gap: 0.75rem; /* Espacio entre los elementos cuando se apilan */
            }
            .main-header .flex.justify-between .flex.items-center {
                 width: 100%; /* Asegura que el logo ocupe todo el ancho si es necesario */
                 justify-content: center;
            }
            .main-header .flex.justify-between .inline-block {
                 width: auto;
            }
            .write-review-button {
                margin-left: 0; /* Reset margin for mobile */
                margin-top: 0.5rem; /* Add top margin for stacking */
            }
            body {
                padding-top: 130px; /* Ajustar padding superior para el encabezado apilado */
            }
            .modal-content {
                width: 95%; /* Más ancho en móviles */
                padding: 1.5rem;
            }
            .modal-header {
                font-size: 1.5rem; /* Título más pequeño en móviles */
                margin-bottom: 1rem;
            }
            .modal-form label {
                font-size: 0.95rem;
            }
            .modal-form input[type="text"],
            .modal-form textarea {
                padding: 0.75rem;
                font-size: 0.95rem;
                margin-bottom: 1rem;
            }
            .modal-star-rating {
                font-size: 1.5rem; /* Estrellas más pequeñas en móviles */
                margin-bottom: 1rem;
            }
            .modal-buttons {
                gap: 1rem;
                margin-top: 1rem;
            }
            .modal-buttons button {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }

            /* Estilos del modal de reglas para móviles */
            .rules-modal-content {
                padding: 1.5rem;
            }
            .rules-modal-content h2 {
                font-size: 1.8rem;
            }
            .rules-modal-content p {
                font-size: 1rem;
            }
            .rules-modal-content ul {
                padding: 0.75rem;
            }
            .rules-modal-content ul li {
                font-size: 0.9rem;
                margin-bottom: 0.5rem;
            }
            .review-acceptance-text {
                font-size: 0.75rem; /* Más pequeño en móviles */
            }
        }
    </style>
</head>
<body class="flex flex-col min-h-screen" style="--star-filled-color: #FACC15; --star-unfilled-color: #D1D5DB;">

    <!-- Video de Fondo -->
    <video autoplay loop muted playsinline id="video-background">
        <source src="./images/fondoreseñas.mp4" type="video/mp4">
        Tu navegador no soporta videos HTML5.
    </video>

    <header id="main-header" class="main-header">
        <div class="w-full px-4 md:px-8 flex justify-between items-center flex-wrap">
            <div class="flex items-center justify-start">
                <img src="./images/logo.ico" alt="Logo de Byte" class="h-16 w-auto object-contain">
            </div>

            <div class="flex items-center space-x-2 md:space-x-4">
                <a href="#" id="write-review-btn" class="write-review-button">
                    Escribe tu reseña
                </a>
                <a href="index.html" class="inline-block bg-yellow-500 text-black font-bold py-2 px-4 rounded-full
                                             shadow-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-110 text-sm">
                    Volver al inicio
                </a>
            </div>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 md:py-12">
        <section class="p-6 md:p-8 text-center">
            <h1 class="text-3xl md:text-4xl font-extrabold text-stroke-cyan mb-12">Opiniones Recientes</h1>

            <!-- Contenedor para las reseñas -->
            <div id="reviews-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Las reseñas se cargarán aquí dinámicamente con JavaScript -->
            </div>

            <!-- Mensaje cuando no hay reseñas -->
            <div id="no-reviews-message" class="text-gray-400 text-lg mt-8">
                Aún no hay reseñas publicadas. ¡Sé el primero en dejar tu opinión!
            </div>
            
            <!-- User ID Display (for debugging/instruction compliance) -->
            <!-- La visualización del ID de usuario ha sido eliminada por solicitud del usuario. -->
            <!-- <div id="user-id-display" class="text-xs text-gray-500 mt-4"></div> -->

        </section>
    </main>

    <footer class="footer bg-byte-secondary-dark text-byte-text-light py-8">
        <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left">
            <div class="md:col-span-3 flex justify-center space-x-4 mt-3">
                <a href="https://www.instagram.com/byteweb_design?utm_source=ig_web_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
                    <svg class="footer-social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                        <radialGradient id="yOrnnhliCrdS2gy~4tD8ma-footer" cx="19.38" cy="42.035" r="44.899" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fd5"/><stop offset=".328" stop-color="#ff543f"/><stop offset=".348" stop-color="#fc5245"/><stop offset=".504" stop-color="#e64771"/><stop offset=".643" stop-color="#d53e91"/><stop offset=".761" stop-color="#cc39a4"/><stop offset=".841" stop-color="#c837ab"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8ma-footer)" d="M34.017,41.99l-20,0.019c-4.4,0.004-8.003-3.592-8.008-7.992l-0.019-20	c-0.004-4.4,3.592-8.003,7.992-8.008l20-0.019c4.4-0.004,8.003,3.592,8.008,7.992l0.019,20	C42.014,38.383,38.417,41.986,34.017,41.99z"/><radialGradient id="yOrnnhliCrdS2gy~4tD8mb-footer" cx="11.786" cy="5.54" r="29.813" gradientTransform="matrix(1 0 0 .6663 0 1.849)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4168c9"/><stop offset=".999" stop-color="#4168c9" stop-opacity="0"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8mb-footer)" d="M34.017,41.99l-20,0.019c-4.4,0.004-8.003-3.592-8.008-7.992l-0.019-20	c-0.004-4.4,3.592-8.003,7.992-8.008l20-0.019c4.4-0.004,8.003,3.592,8.008,7.992l0.019,20	C42.014,38.383,38.417,41.986,34.017,41.99z"/><path fill="#fff" d="M24,31c-3.859,0-7-3.14-7-7s3.141-7,7-7s7,3.14,7,7S27.859,31,24,31z M24,19c-2.757,0-5,2.243-5,5	s2.243,5,5,5s5-2.243,5-5S26.757,19,24,19z"/><circle cx="31.5" cy="16.5" r="1.5" fill="#fff"/><path fill="#fff" d="M30,37H18c-3.859,0-7-3.14-7-7V18c0-3.86,3.141-7,7-7h12c3.859,0,7,3.14,7,7v12	C37,33.86,33.859,37,30,37z M18,13c-2.757,0-5,2.243-5,5v12c0,2.757,2.243,5,5,5h12c2.757,0,5-2.243,5-5V18c0-2.757-2.243-5-5-5H18z"/>
                    </svg>
                </a>
                <a href="https://wa.me/584125646508" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp">
                    <i class="fab fa-whatsapp footer-social-icon text-byte-text-light"></i>
                </a>
            </div>
        </div>
        <div class="container mx-auto px-4 text-center text-xs text-gray-400 mt-8 border-t border-gray-700 pt-4">
            <p class="mb-2">
                Al navegar en la página de Byte, aceptas nuestros
                <a href="#" class="text-byte-accent-cyan hover:underline disabled-link">Términos de Servicio</a> y
                <a href="#" class="text-byte-accent-cyan hover:underline disabled-link">Condiciones</a>.
            </p>
            <p>© 2025 Byte. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- Modal para escribir reseña -->
    <div id="review-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="modal-header">Escribe tu reseña</h2>
            <form id="review-form" class="modal-form">
                <div class="mb-4">
                    <label for="reviewer-name">Tu nombre</label>
                    <input type="text" id="reviewer-name" placeholder="Ej: Juan Pérez" required>
                </div>
                <div class="mb-4">
                    <label>Calificación</label>
                    <div id="star-rating-input" class="modal-star-rating">
                        <i class="fas fa-star star-icon unselected" data-value="1"></i>
                        <i class="fas fa-star star-icon unselected" data-value="2"></i>
                        <i class="fas fa-star star-icon unselected" data-value="3"></i>
                        <i class="fas fa-star star-icon unselected" data-value="4"></i>
                        <i class="fas fa-star star-icon unselected" data-value="5"></i>
                    </div>
                    <input type="hidden" id="review-rating" value="0"> <!-- Hidden field to store the rating -->
                </div>
                <div class="mb-4">
                    <label for="review-text">Tu reseña</label>
                    <textarea id="review-text" placeholder="Escribe tu opinión aquí..." rows="5" required></textarea>
                </div>
                <!-- Texto de aceptación de reglas dentro del modal de reseña -->
                <p class="review-acceptance-text">
                    Al publicar tu reseña, aceptas las <a href="#" class="text-byte-accent-cyan hover:underline disabled-link">reglas y condiciones de Byte web design</a>.
                </p>
                <div class="modal-buttons">
                    <button type="button" id="cancel-review-btn" class="cancel-button">Cancelar</button>
                    <button type="submit" id="submit-review-btn" class="submit-button">Publicar reseña</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Aceptación de Reglas (Nuevo) -->
    <div id="rules-modal" class="rules-modal-overlay">
        <div class="rules-modal-content">
            <h2>Reglas de la Comunidad Byte</h2>
            <p>Para asegurar un ambiente positivo y constructivo, te pedimos que leas y aceptes las siguientes reglas antes de continuar:</p>
            <ul>
                <li>No compartir negocios, links externos o emprendimientos no relacionados con Byte.</li>
                <li>Prohibido el uso de groserías, lenguaje ofensivo o cualquier tipo de contenido inapropiado.</li>
                <li>Mantén el respeto hacia todos los usuarios y sus opiniones.</li>
                <li>Evita el spam y la autopromoción excesiva.</li>
                <li>Estas reglas son de carácter empresarial y académico, buscando fomentar un intercambio de información valioso y respetuoso.</li>
            </ul>
            <button id="accept-rules-btn" class="accept-button">Acepto las reglas</button>
        </div>
    </div>

    <script type="text/javascript" src="https://chatsimple-widget.s3.us-east-2.amazonaws.com/chat-bot-loader.js"></script>
    <script type="text/javascript">
        // Script for the chatbot
        (function() {
            var chatBotEl = document.createElement('chat-bot');
            // Usando los IDs del chatbot de la última actualización de graphic-design-page
            chatBotEl.setAttribute('platform_id', '7def0408-a3e8-4a58-90bb-c6e5e3e750b2');
            chatBotEl.setAttribute('user_id', 'e71d960f-62bf-4b52-9c34-89801d0d8023');
            chatBotEl.setAttribute('chatbot_id', 'cb3c57ca-bd69-47a9-8df1-1e2756ae556a');
            var chatbotLink = document.createElement('a');
            chatbotLink.href = 'https://www.chatsimple.ai/?utm_source=widget&utm_medium=referral';
            chatbotLink.innerHTML = 'chatsimple';
            chatBotEl.appendChild(chatbotLink);
            document.body.appendChild(chatBotEl); // Append the custom element to the body
        })();
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainHeader = document.getElementById('main-header');
            let lastScrollY = 0;

            // Header show/hide logic
            window.addEventListener('scroll', () => {
                const currentScrollY = window.scrollY;
                if (currentScrollY > lastScrollY && currentScrollY > 0) {
                    mainHeader.classList.add('header-hide');
                } else if (currentScrollY < lastScrollY || currentScrollY === 0) {
                    mainHeader.classList.remove('header-hide');
                }
                lastScrollY = currentScrollY;
            });

            const reviewsContainer = document.getElementById('reviews-container');
            const noReviewsMessage = document.getElementById('no-reviews-message');

            // Modal elements (Review Modal)
            const writeReviewBtn = document.getElementById('write-review-btn');
            const reviewModal = document.getElementById('review-modal');
            const cancelReviewBtn = document.getElementById('cancel-review-btn');
            const reviewForm = document.getElementById('review-form');
            const starRatingInput = document.getElementById('star-rating-input');
            const reviewRatingInput = document.getElementById('review-rating'); // Hidden input for rating
            let currentRating = 0; // To store the selected rating

            // Rules Modal elements
            const rulesModal = document.getElementById('rules-modal');
            const acceptRulesBtn = document.getElementById('accept-rules-btn');

            // --- Rules Modal Logic ---
            // Function to disable/enable scroll on body
            function toggleBodyScroll(enable) {
                if (enable) {
                    document.body.classList.remove('modal-open');
                } else {
                    document.body.classList.add('modal-open');
                }
            }

            // Show rules modal on page load
            // This is handled by default visibility in CSS,
            // but we ensure body scroll is disabled.
            toggleBodyScroll(false); // Disable scroll initially

            acceptRulesBtn.addEventListener('click', () => {
                rulesModal.classList.add('hidden'); // Hide the rules modal
                toggleBodyScroll(true); // Enable body scroll
            });

            // --- Review Modal Logic ---
            // Show review modal
            writeReviewBtn.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default link behavior
                reviewModal.classList.add('show');
                toggleBodyScroll(false); // Disable body scroll when review modal is open
                // Reset form fields when opening
                reviewForm.reset();
                currentRating = 0;
                updateStarRating(0); // Reset stars
                reviewRatingInput.value = 0;
            });

            // Hide review modal
            cancelReviewBtn.addEventListener('click', () => {
                reviewModal.classList.remove('show');
                toggleBodyScroll(true); // Enable body scroll when review modal is closed
            });

            // Hide review modal if clicking outside the content
            reviewModal.addEventListener('click', (e) => {
                if (e.target === reviewModal) {
                    reviewModal.classList.remove('show');
                    toggleBodyScroll(true); // Enable body scroll when review modal is closed
                }
            });

            // Star rating interaction (for review modal)
            starRatingInput.addEventListener('mouseover', (e) => {
                if (e.target.classList.contains('star-icon')) {
                    const value = parseInt(e.target.dataset.value);
                    updateStarRating(value, true); // Highlight on hover
                }
            });

            starRatingInput.addEventListener('mouseout', () => {
                updateStarRating(currentRating); // Revert to selected rating on mouse out
            });

            starRatingInput.addEventListener('click', (e) => {
                if (e.target.classList.contains('star-icon')) {
                    currentRating = parseInt(e.target.dataset.value);
                    updateStarRating(currentRating); // Set selected rating
                    reviewRatingInput.value = currentRating; // Update hidden input
                }
            });

            // Function to update star visuals (for review modal)
            function updateStarRating(rating, isHover = false) {
                const stars = starRatingInput.querySelectorAll('.star-icon');
                stars.forEach(star => {
                    const starValue = parseInt(star.dataset.value);
                    if (isHover) {
                        if (starValue <= rating) {
                            star.classList.add('selected');
                            star.classList.remove('unselected');
                        } else {
                            star.classList.remove('selected');
                            star.classList.add('unselected');
                        }
                    } else { // Not hover, apply actual selected rating
                        if (starValue <= rating) {
                            star.classList.add('selected');
                            star.classList.remove('unselected');
                        } else {
                            star.classList.remove('selected');
                            star.classList.add('unselected');
                        }
                    }
                });
            }

            // Handle review submission
            reviewForm.addEventListener('submit', async (e) => {
                e.preventDefault(); // Prevent default form submission

                const reviewerName = document.getElementById('reviewer-name').value;
                const reviewText = document.getElementById('review-text').value;
                const rating = parseInt(reviewRatingInput.value);

                if (reviewerName && reviewText && rating > 0) {
                    const newReview = {
                        name: reviewerName,
                        rating: rating,
                        text: reviewText
                    };

                    await window.addReviewToFirestore(newReview); // Use the global function to add to Firestore

                    // Hide the modal
                    reviewModal.classList.remove('show');
                    toggleBodyScroll(true); // Enable body scroll after submission

                    // Reset form
                    reviewForm.reset();
                    currentRating = 0;
                    updateStarRating(0);
                    reviewRatingInput.value = 0;
                } else {
                    window.displayMessage('Por favor, rellena todos los campos y selecciona una calificación.', 'bg-red-500');
                }
            });

            // The functions below are now redundant as they are handled by Firebase's onSnapshot
            // function addReviewToDisplay(review) { ... }
            // function createReviewCard(review) { ... }
            // function generateStars(rating) { ... }
            // function displayMessage(text, bgColor) { ... } // Replaced by global function

            // Initial check for reviews message (will be updated by onSnapshot)
            // This is just a fallback, onSnapshot will manage visibility.
            if (reviewsContainer.children.length === 0) {
                noReviewsMessage.classList.remove('hidden');
            } else {
                noReviewsMessage.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
